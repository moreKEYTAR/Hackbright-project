{% extends 'base.html' %}

{% block title %}My SamePage Teams{% endblock %}

{% block content %}

<!-- ************************** DATA FROM SERVER ************************** -->
  <!-- team    ..... an object
  Refer to model to see Team attributes and relationships-->

<style type="text/css">
   .board > button {
    background-color:#30bdc0;
    }
    .board {
    display:inline-block;
    /*float:left; */
    /* I had to add the float to get them to be inline at all*/
    vertical-align: top;
    background-color: yellow;
    width:30%;
    }
    #all-team-boards {
      width:90%;
      background-color: pink;
    }
    .modal {
      display:none; /* Starts hidden, using CSS */
      position:fixed; /* Stays in place. - W3Schools. Learn more. */
      z-index:1; /* On top; higher numbers go toward the user, covering page */
      left:0; top:0; /* Not sure...learn more later */
      width:100%; height:100%;
      overflow:auto; /* "Enable scroll if needed" */
      background-color: rgb(71, 71, 107);
      background-color: rgba(71, 71, 107, 0.9); 
        /* Standard rgb color with alpha or opacity */
        /* http://www.css3.info/introduction-opacity-rgba/ */
    }
    .modal-content { /* Borrowed from W3Schools 'how to css modals'*/
        /*position:absolute;*/
        background-color: #fefefe;
        margin: 20% auto; /* 20% from the top and centered */
        padding: 20px;
        border: 1px solid #999999;
        width: 50%;
        height:auto;
    }
    .close {  /* The Close Button */
        /*position:absolute;*/
        color: #999999;
        float: right;
        font-size: 24px;
        font-weight: bold;
    }
    .close:hover, .close:focus { /* Borrowed from W3Schools 'how to css modals'*/
        color: black;
        text-decoration: none;
        cursor: pointer; /* I think this is for the cursor hovering on the close*/
    }
</style>

<!-- ************************** MAIN HTML BODY ************************** --> 

<p>{{ team.t_id }}</P>

<h1>Team home: {{ team.name }}</h1>
{% if team.desc %}
<h5>{{ team.desc }}</h5>
{% endif %}

<br>
<h3>Your Boards</h3>

{% if team.boards %}

  <div id="all-team-boards">
    {% for board in team.boards %}
      
      <!-- BOARD DIV: HAS TWO CHILD NODES:
           show-projects-... & make-new-project... -->
      <div class="board" id="{{ board.b_id }}">
        <button type="button" class="board-button" 
                data-board-id="{{ board.b_id }}">
                {{ board.name }}</button>
        <p class="description">{{ board.desc }}</p>
            
            <!-- Board button above is always visible; projects are
                 visible based on clicking that board button. Then all other 
                 show projects divs hid, and this one shows for the 
                 event.target / project button that was clicked. -->


        <!-- CHILD (A) FROM THE BOARD DIV -->
        <div id="show-projects-{{ board.b_id }}" 
             class="show-projects" hidden>
          
          {% if board.projects %}
            <div class="if-board-has-projects">
              
                {% for project in board.projects %}
                  <br>
                  <div class="project" 
                       id="{{ project.p_id }}" 
                       data-parent="{{board.b_id}}" 
                       data-phase="{{ project.phase_code }}"
                       data-claiming-user="{{ project.user_id }}"
                       data-updated="{{ project.updated }}">
                    <button type="button">{{ project.title }}</button>
                    <input type="hidden" name="notes" value="{{ project.notes }}">
                    {% if project.upvotes %}
                      <h5>+ {{ project.upvotes}}</h5>
                    {% endif %}
                    {% if project.user_id %}
                      <h5>{{ project.user.displayname }}</h5>
                    {% endif %}
                  </div> <!-- closes project div -->

                {% endfor %} <!-- ends the for each project loop -->

            </div> <!-- closes if-board-has-projects div -->
          
          {% else %} <!-- If there are no projects yet -->

            <p class="encouragement">No projects yet!</p>

          {% endif %} <!-- ends "if board.projects" check -->

        </div> <!-- closes show-projects div -->


        <!-- CHILD (B) FROM THE BOARD DIV -->

        <!-- Make a new project for the board: DIV & BUTTON -->
        <div id="make-new-project-{{board.b_id}}" 
             class="make-new-project" hidden>

          <button type="button" id="new-item-button" 
                  data-team-id="{{ team.t_id }}">
           Add a new to do ITEM</button>
          <button type="button" id="new-idea-button" 
                  data-team-id="{{ team.t_id }}">
           Add an IDEA to the board</button>

        </div> <!-- closes new project div -->
      
      </div> <!-- closes board div -->
    
    {% endfor %} <!-- ends the for each board loop -->
  
  </div> <!-- closes all-team-boards div -->

{% else %} <!-- If there are no boards yet -->

<p class="encouragement">No boards yet. Click below to make one!</p>

{% endif %} <!-- ends the if team.boards check -->

<br><br>

<!-- MAKE A NEW BOARD FOR THE TEAM: DIV & BUTTON -->
<div id="make-new-board">
  <button type="button" id="new-board" 
          data-team-id="{{ team.t_id }}">Add a new board</button>
</div>


<!-- MODAL DIVS CREATED BY REFERENCING HTML/CSS TUTORIAL from W3Schools  -->

<!-- MODAL WINDOW, TRIGGERED BY MAKE NEW BOARD BUTTON -->
<!-- This modal starts hidden, using css display:none -->
<div id="new-board-modal" class="modal"> 

    <!-- MODAL WINDOW CONTENT -->
    <div class="modal-content">
      <span id="modal-close">&times;</span>
      <!-- &times; makes a perfectly angled x. search "HTML entities" -->

      <!-- MODAL FORM -->
      <h3>Make a new board</h3>
      
      <form action="/new-board" method="POST" 
            id="make-new-board-form">
        <span>Name your board:</span>
        <input type="text" name="new-board-name" placeholder="required"
               required><br>
        <span>Description:</span>
        <div>
          <textarea form="make-new-board-form" name="new-board-desc"
                    placeholder="optional"></textarea>
        </div>
        <input type="hidden" name="team-id" value="{{ team.t_id }}">
        <input type="submit" value="Submit" id="submit-new-board-form">
      
      </form> <!-- Close form -->

    </div> <!-- Close "modal-content" -->
</div> <!-- Close "new-board-modal" -->

<br>

<!-- **************************** SCRIPTS **************************** --> 

<!-- jQuery inherited from base.html -->
<script src="/static/scripts/team-main.js"></script>

{% endblock %}
